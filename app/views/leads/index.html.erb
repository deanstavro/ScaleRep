<div id="title" class="jumbotron">
  <div class = "container">
    <br/>
    <h1><%= @user.client_company.name if @user.client_company %> Lead List</h1>
  </div>
</div>


<div class="thin-margins">
  <h2> Upload CSV Lead List</h2>
  <p class="notice"><%= notice %></p>

  <h3> * duplicates will not be uploaded </h3>

  <p> Use these fields when uploading:
  <br>- first_name -> first name of lead*
  <br>- last_name -> last name of lead*
  <br>- email -> email name of lead*
  <br>- campaign_name -> reply ID of campaign
  <br>- title -> title or position of the lead in company
  <br>- company -> company lead works on behalf of
  <br>
  <br>- company_domain -> website of company
  <br>- phone_type -> whether included number is direct or of headquarters
  <br>- phone_number -> phone number of contact
  <br>- linkedin -> linkedIn of lead
  <br>- timezone -> timezone of person

</p>



    
    <%= form_tag import_leads_path, multipart: true do %>

    <%= file_field_tag :file %>
    <%= submit_tag "Import CSV" %>
  <% end %>
</div>

<% if false %>
<div class="container">
  <h2> Qualified Leads</h2>
  <table class="table table-striped">
    <thead class="thead-light">
      <tr>
        <th scope="col">Date Sourced</th>
        <th scope="col">Handed To:</th>
        <th scope="col">Name</th>
        <th scope="col">Company</th>
        <th scope="col">Timeline</th>
        <th scope="col">Scope</th>
        <th scope="col">Other Notes</th>
        <th scope="col">Predicted Deal Size</th>

        <th scope="col">Contract Sent?</th>
        <th scope="col">Contract Amount</th>

      </tr>
    </thead>

    <tbody>
      <% @leads.each do |lead| %>
        <tr>
          <td><%= lead.date_sourced.strftime("%m-%d-%Y") %></td>
          <td><%= lead.email_handed_off_too %></td>
          <td><%= lead.name %></td>
          <td><%= lead.company %></td>
          <td><%= lead.timeline %></td>
          <td><%= lead.project_scope %></td>
          <td><%= lead.external_notes %></td>
          <td>$<%= lead.potential_deal_size %></td>

          <td><%= lead.contract_sent %></td>
          <td>$<%= lead.contract_amount %></td>


        </tr>

      <% end %>
    </tbody>
  </table>
</div>
<% end %>



<div class = 'thin_margins'>
  <h2> Qualified Leads</h2>

  <% if @qualified_opps.count > 0 %>

  
    <div class = "qualified_leads" style="overflow: auto;">
      <table class = " airtable_data table table-striped">
          <thead class = "thead-dark">
            <tr>
              <% @qualified_opps[0].column_mappings.values.each do |column_map| %>
                <% if column_map != "campaign" && column_map != "Product" && column_map != "notes" && column_map != "last_touchpoint" %>
                  <th scope = 'col'><%= column_map %></th>
                <% end %>
              <% end %>
            </tr>
          </thead>

          <tbody>
            <% @qualified_opps.each do |lead| %>
              <tr>
                <% lead.fields.each do |field| %>
                  <% if field[0] != "campaign" && field[0] != "Product" && field[0] != "notes" && field[0] != "last_touchpoint" %>
                    <td> <%= field[1] %></td>
                  <% end %>
                <% end %>
              </tr>
            <% end %>
          </tbody>
      </table>

    </div>
  <% else %>

    <p> No qualified leads </p>
    
  <% end %>




  <h2> Pending Leads</h2>

  <% if @pending_opps.count > 0 %>

    <div class = "pending_leads" style="overflow: auto;">
      <table class = " airtable_data table table-striped">
          <thead class = "thead-dark">
            <tr>
              <% @pending_opps[0].column_mappings.values.each do |column_map| %>
                <% if column_map != "campaign" && column_map != "Product" && column_map != "notes" && column_map != "handed_off_to" && column_map !="predicted_deal_size" && column_map !="contract_stage" %>
                  <th scope = 'col'><%= column_map %></th>
                <% end %>
              <% end %>
            </tr>
          </thead>

          <tbody>
            <% @pending_opps.each do |lead| %>
              <tr>
                <% lead.fields.each do |field| %>
                  <% if field[0] != "campaign" && field[0] != "Product" && field[0] != "notes" && field[0] != "handed_off_to" && field[0] !="predicted_deal_size" && field[0] !="contract_stage" %>
                    <td> <%= field[1] %></td>
                  <% end %>
                <% end %>
              </tr>
            <% end %>
          </tbody>
      </table>
    </div>

  <% else %>

    <p> No pending leads </p>
    
  <% end %>
</div>
